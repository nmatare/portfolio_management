% Modify this program as necessary to generate solutions for Assignment 8 in Portfolio Management. f
clear all
fu = load('fund_holding.txt');
ff = load('ff_factors_192607_201612.txt');
f = ismember(ff(:,1),fu(:,1));
ff = ff(f,:)/100;
rmrf = ff(:,2);         
rf = ff(:,end);        
rm = rmrf + rf;         
w = fu(:,2);            
r = w.*rm + (1-w).*rf;  
T = size(r,1);
y = r-rf;
x = [ones(T,1) rmrf];
b = x\y;
e = y-x*b;
sigma2 = e'*e/T;
se = sqrt(diag(sigma2*inv(x'*x)));
alphahat = b(1);
betahat = b(2);
t_alphahat = b(1)/se(1);
x = [ones(T,1) rmrf rmrf.*(rmrf>0)];
b = x\y;
e = y-x*b;
sigma2 = e'*e/T;
se = sqrt(diag(sigma2*inv(x'*x)));
ghat1 = b(3);
t_ghat1 = b(3)/se(3);
x = [ones(T,1) rmrf rmrf.^2];
b = x\y;
e = y-x*b;
sigma2 = e'*e/T;
se = sqrt(diag(sigma2*inv(x'*x)));
ghat2 = b(3);
t_ghat2 = b(3)/se(3);
gt1 = (w(1:end-1)-w(2:end)).*rm(1:end-1);
gt2 = (w(1:end-1)-w(2:end)).*rm(2:end);
gt3 = (w(2:end)-w(1:end-1)).*rm(1:end-1);
gt4 = (w(2:end)-w(1:end-1)).*rm(2:end);
gt1_stat = [mean(gt1); std(gt1); sqrt(length(gt1))*mean(gt1)/std(gt1)];
gt2_stat = [mean(gt2); std(gt2); sqrt(length(gt2))*mean(gt2)/std(gt2)];
gt3_stat = [mean(gt3); std(gt3); sqrt(length(gt3))*mean(gt3)/std(gt3)];
gt4_stat = [mean(gt4); std(gt4); sqrt(length(gt4))*mean(gt4)/std(gt4)];